<Window x:Class="PersonalFinanceApp.DashboardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
        Title="Личный кабинет" Height="600" Width="800"
        Background="#F5F7FA"
        WindowStartupLocation="CenterScreen"
        TextOptions.TextFormattingMode="Display">
    <Window.Resources>
        <!-- Стиль для кнопок -->
        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#2A3F8D"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontFamily" Value="Segoe UI Semibold"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="5"
                                BorderThickness="0">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            <Border.Effect>
                                <DropShadowEffect ShadowDepth="2" BlurRadius="5" Opacity="0.3" Color="Black"/>
                            </Border.Effect>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#3B54C1"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#1F2A6B"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Стиль для кнопки "Добавить" (зелёный цвет) -->
        <Style x:Key="AddButtonStyle" TargetType="Button" BasedOn="{StaticResource ModernButtonStyle}">
            <Setter Property="Background" Value="#4CAF50"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#66BB6A"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#388E3C"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Стиль для текстовых полей -->
        <Style x:Key="ModernTextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#D3D3D3"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5">
                            <ScrollViewer x:Name="PART_ContentHost" Margin="2"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="BorderBrush" Value="#2A3F8D"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Стиль для выпадающих списков -->
        <Style x:Key="ModernComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#D3D3D3"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ComboBox">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="20"/>
                            </Grid.ColumnDefinitions>
                            <!-- Основной контейнер для отображения выбранного элемента -->
                            <Border Grid.Column="0"
                                    Grid.ColumnSpan="2"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    CornerRadius="5">
                                <ContentPresenter x:Name="ContentSite"
                                                  Content="{TemplateBinding SelectionBoxItem}"
                                                  ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}"
                                                  ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}"
                                                  Margin="5,0"
                                                  VerticalAlignment="Center"
                                                  HorizontalAlignment="Left"/>
                            </Border>
                            <!-- Кнопка для раскрытия списка (стрелка) -->
                            <ToggleButton Grid.Column="1"
                                          x:Name="ToggleButton"
                                          Background="Transparent"
                                          BorderThickness="0"
                                          IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                          Focusable="False"
                                          ClickMode="Press">
                                <Path Data="M 0 0 L 4 4 L 8 0 Z"
                                      Fill="#333333"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>
                            </ToggleButton>
                            <!-- Выпадающий список -->
                            <Popup x:Name="Popup"
                                   IsOpen="{TemplateBinding IsDropDownOpen}"
                                   Placement="Bottom"
                                   AllowsTransparency="True"
                                   Focusable="False"
                                   PopupAnimation="Slide">
                                <Border Background="White"
                                        BorderBrush="#D3D3D3"
                                        BorderThickness="1"
                                        CornerRadius="5"
                                        MaxHeight="{TemplateBinding MaxDropDownHeight}">
                                    <ScrollViewer>
                                        <ItemsPresenter/>
                                    </ScrollViewer>
                                </Border>
                            </Popup>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsFocused" Value="True">
                                <Setter Property="BorderBrush" Value="#2A3F8D"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="BorderBrush" Value="#2A3F8D"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Стиль для текстовых меток -->
        <Style x:Key="ModernTextBlockStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
        </Style>

        <!-- Стиль для вкладок -->
        <Style x:Key="ModernTabItemStyle" TargetType="TabItem">
            <Setter Property="FontFamily" Value="Segoe UI Semibold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Border x:Name="Border"
                                Background="Transparent"
                                BorderThickness="0,0,0,2"
                                BorderBrush="Transparent"
                                Margin="5,0">
                            <ContentPresenter x:Name="ContentSite"
                                              ContentSource="Header"
                                              Margin="10,5"
                                              HorizontalAlignment="Center"
                                              VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="BorderBrush" Value="#2A3F8D"/>
                                <Setter Property="Foreground" Value="#2A3F8D"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Foreground" Value="#3B54C1"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Стиль для списка транзакций -->
        <Style x:Key="ModernListViewStyle" TargetType="ListView">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#D3D3D3"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ListView">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="5">
                            <ScrollViewer>
                                <ItemsPresenter/>
                            </ScrollViewer>
                            <Border.Effect>
                                <DropShadowEffect ShadowDepth="1" BlurRadius="3" Opacity="0.2" Color="Black"/>
                            </Border.Effect>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Margin="10">
        <TabControl Background="Transparent" BorderThickness="0">
            <!-- Вкладка транзакций -->
            <TabItem Header="Транзакции" Style="{StaticResource ModernTabItemStyle}">
                <StackPanel Margin="10">
                    <!-- Поля для добавления транзакции -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Тип транзакции:" Margin="0,0,5,0" Style="{StaticResource ModernTextBlockStyle}"/>
                        <ComboBox x:Name="TransactionTypeComboBox" Width="100" Style="{StaticResource ModernComboBoxStyle}">
                            <ComboBoxItem Content="Доход"/>
                            <ComboBoxItem Content="Расход"/>
                        </ComboBox>
                        <TextBlock Text="Сумма:" Margin="10,0,5,0" Style="{StaticResource ModernTextBlockStyle}"/>
                        <TextBox x:Name="TransactionAmountTextBox" Width="100" Style="{StaticResource ModernTextBoxStyle}"/>
                        <TextBlock Text="Категория:" Margin="10,0,5,0" Style="{StaticResource ModernTextBlockStyle}"/>
                        <ComboBox x:Name="CategoryComboBox" Width="100" Style="{StaticResource ModernComboBoxStyle}"/>
                        <TextBlock Text="Описание:" Margin="10,0,5,0" Style="{StaticResource ModernTextBlockStyle}"/>
                        <TextBox x:Name="TransactionDescriptionTextBox" Width="200" Style="{StaticResource ModernTextBoxStyle}"/>
                        <Button Content="Добавить" Width="80" Margin="10,0,0,0" Style="{StaticResource AddButtonStyle}" Click="AddTransactionButton_Click"/>
                    </StackPanel>
                    <!-- Поля для поиска -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Поиск по описанию, типу или сумме:" Margin="0,0,5,0" Style="{StaticResource ModernTextBlockStyle}"/>
                        <TextBox x:Name="SearchTextBox" Width="200" Style="{StaticResource ModernTextBoxStyle}"/>
                        <Button Content="Поиск" Width="80" Margin="10,0,0,0" Style="{StaticResource ModernButtonStyle}" Click="SearchButton_Click"/>
                        <Button Content="Сбросить" Width="80" Margin="10,0,0,0" Style="{StaticResource ModernButtonStyle}" Click="ResetSearchButton_Click"/>
                    </StackPanel>
                    <!-- Поля для сортировки -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Сортировать по:" Margin="0,0,5,0" Style="{StaticResource ModernTextBlockStyle}"/>
                        <ComboBox x:Name="SortColumnComboBox" Width="120" Style="{StaticResource ModernComboBoxStyle}">
                            <ComboBoxItem Content="Тип"/>
                            <ComboBoxItem Content="Сумма"/>
                            <ComboBoxItem Content="Дата"/>
                            <ComboBoxItem Content="Описание"/>
                        </ComboBox>
                        <ComboBox x:Name="SortDirectionComboBox" Width="120" Margin="10,0,0,0" Style="{StaticResource ModernComboBoxStyle}">
                            <ComboBoxItem Content="По возрастанию"/>
                            <ComboBoxItem Content="По убыванию"/>
                        </ComboBox>
                        <Button Content="Сортировать" Width="80" Margin="10,0,0,0" Style="{StaticResource ModernButtonStyle}" Click="SortButton_Click"/>
                    </StackPanel>
                    <!-- Список транзакций -->
                    <ListView x:Name="TransactionsListView" Height="200" Style="{StaticResource ModernListViewStyle}">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Тип" DisplayMemberBinding="{Binding Type}"/>
                                <GridViewColumn Header="Сумма" DisplayMemberBinding="{Binding Amount}"/>
                                <GridViewColumn Header="Дата и время" DisplayMemberBinding="{Binding Date, StringFormat=dd/MM/yyyy HH:mm}"/>
                                <GridViewColumn Header="Описание" DisplayMemberBinding="{Binding Description}"/>
                                <GridViewColumn Header="Действия">
                                    <GridViewColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Content="Редактировать" Tag="{Binding Id}" Style="{StaticResource ModernButtonStyle}" Click="EditTransactionButton_Click" Margin="0,0,5,0"/>
                                                <Button Content="Удалить" Tag="{Binding Id}" Style="{StaticResource ModernButtonStyle}" Click="DeleteTransactionButton_Click"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </GridViewColumn.CellTemplate>
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>
                    </ListView>
                </StackPanel>
            </TabItem>

            <!-- Вкладка категорий -->
            <TabItem Header="Категории" Style="{StaticResource ModernTabItemStyle}">
                <StackPanel Margin="10">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Название категории:" Margin="0,0,5,0" Style="{StaticResource ModernTextBlockStyle}"/>
                        <TextBox x:Name="CategoryNameTextBox" Width="200" Style="{StaticResource ModernTextBoxStyle}"/>
                        <Button Content="Добавить категорию" Width="120" Margin="10,0,0,0" Style="{StaticResource AddButtonStyle}" Click="AddCategoryButton_Click"/>
                    </StackPanel>
                    <ListView x:Name="CategoriesListView" Height="200" Style="{StaticResource ModernListViewStyle}">
                        <ListView.View>
                            <GridView>
                                <GridViewColumn Header="Название" DisplayMemberBinding="{Binding Name}"/>
                            </GridView>
                        </ListView.View>
                    </ListView>
                </StackPanel>
            </TabItem>

            <!-- Вкладка отчетов -->
            <TabItem Header="Отчеты" Style="{StaticResource ModernTabItemStyle}">
                <StackPanel Margin="10">
                    <Button Content="Посмотреть расходы по категориям" Width="200" Margin="0,0,0,10" Style="{StaticResource ModernButtonStyle}" Click="ViewExpensesByCategoryButton_Click"/>
                    <Button Content="Общий отчет (доходы и расходы)" Width="200" Margin="0,0,0,10" Style="{StaticResource ModernButtonStyle}" Click="ViewSummaryReportButton_Click"/>
                    <TextBlock x:Name="ReportTextBlock" TextWrapping="Wrap" Margin="0,0,0,10" Style="{StaticResource ModernTextBlockStyle}"/>
                    <lvc:PieChart x:Name="ExpensesPieChart" Height="300" Margin="0,0,0,10" LegendLocation="Right"/>
                </StackPanel>
            </TabItem>

            <!-- Вкладка настроек -->
            <TabItem Header="Настройки" Style="{StaticResource ModernTabItemStyle}">
                <StackPanel Margin="10">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="Выберите валюту:" Margin="0,0,5,0" Style="{StaticResource ModernTextBlockStyle}"/>
                        <ComboBox x:Name="CurrencyComboBox" Width="100" Style="{StaticResource ModernComboBoxStyle}">
                            <ComboBoxItem Content="руб."/>
                            <ComboBoxItem Content="евро"/>
                            <ComboBoxItem Content="долл."/>
                        </ComboBox>
                        <Button Content="Сохранить валюту" Width="120" Margin="10,0,0,0" Style="{StaticResource ModernButtonStyle}" Click="SaveCurrencyButton_Click"/>
                    </StackPanel>
                </StackPanel>
            </TabItem>
        </TabControl>
    </Grid>
</Window>